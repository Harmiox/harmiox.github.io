/* This includes 4 files: bootstrap/usernames.js, bootstrap/plugins.js, bootstrap/userfields.js, bootstrap/colorpicker.js */
var originalLeave=jQuery.fn.popover.Constructor.prototype.leave;jQuery.fn.popover.Constructor.prototype.leave=function(a){var b,c,d=a instanceof this.constructor?a:jQuery(a.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);originalLeave.call(this,a),a.currentTarget&&(b=jQuery(a.currentTarget).siblings(".popover"),c=d.timeout,b.one("mouseenter",function(){clearTimeout(c),b.one("mouseleave",function(){jQuery.fn.popover.Constructor.prototype.leave.call(d,d)})}))},jQuery(document).ready(function(){var a=1;jQuery(document).on("mouseover","[rel^=bubbletip_]",function(){var b=jQuery(this),c="",d="";if(b.attr("rel").match("bubbletip_user_")){var e=b.attr("rel").replace(/bubbletip_user_(\d+).*/g,"$1");c="popover_cache_user_"+e,d="&userid="+e}else if(b.attr("rel").match("bubbletip_comment_")){var f=b.attr("rel").replace(/bubbletip_comment_(\d+).*/,"$1");c="popover_cache_comment_"+f,d="&commentid="+f}if(""!=c){b.attr("id","popoverlink"+a);var g={trigger:"hover",placement:"top",html:!0,delay:{hide:400},template:'<div class="popover"><div class="arrow"></div><div class="popover-content"></div></div>'};if(0==jQuery("#"+c).length){jQuery("body").append('<div id="'+c+'" style="display:none;"></div>');var h=jQuery("#"+c);jQuery.ajax({type:"POST",url:htsrv_url+"anon_async.php",data:"action=get_user_bubbletip&blog="+blog_id+d,success:function(a){if(ajax_response_is_correct(a)){a=ajax_debug_clear(a),h.html(a);var c=!0;b.hasClass("hide_popover")&&(c=!1,b.removeClass("hide_popover")),g.content=h.html(),b.popover(g),c&&b.popover("show"),b.attr("rel",b.attr("rel").replace(/bubbletip_(user_|comment_)[\d\s]+/g,"")),console.log("ajax")}}})}else if(""!=jQuery("#"+c).html()){var i=b.attr("title");b.removeAttr("title"),g.content=jQuery("#"+c).html(),b.popover(g),b.popover("show"),b.attr("title",i),b.attr("rel",b.attr("rel").replace(/bubbletip_(user_|comment_)[\d\s]+/g,""))}a++}}),jQuery(document).on("mouseleave","[rel^=bubbletip_]",function(){jQuery(this).addClass("hide_popover")})});var plugin_number=1;jQuery(document).on("mouseover","a.help_plugin_icon",function(){if(jQuery(this).hasClass("popoverplugin"))return!0;jQuery(this).attr("title",""),jQuery(this).find("span").removeAttr("title");var a=jQuery(this).attr("rel");jQuery("#help_plugin_info_suffix").length>0&&(a+=jQuery("#help_plugin_info_suffix").html());var b="right";jQuery("body").width()-jQuery(this).position().left<220&&(b="left"),jQuery(this).popover({trigger:"hover",placement:b,html:!0,content:a,template:'<div class="popover popover-plugin"><div class="arrow"></div><div class="popover-content"></div></div>'}),jQuery(this).popover("show"),jQuery(this).addClass("popoverplugin"),plugin_number++}),jQuery(document).ready(function(){var a=1;jQuery(document).on("focus","[rel^=ufdf_]",function(){var b=jQuery(this),c="";if(!b.hasClass("popoverfield"))var d=b.attr("rel").replace("ufdf_",""),c="popover_cache_field_"+d;if(""!=c){var e={trigger:"focus",placement:"right",html:!0,template:'<div class="popover popover-userfield"><div class="arrow"></div><div class="popover-content"></div></div>'};if(0==jQuery("#"+c).length){jQuery("body").append('<div id="'+c+'" style="display:none"></div>');var f=jQuery("#"+c);jQuery.ajax({type:"POST",url:htsrv_url+"anon_async.php",data:"action=get_field_bubbletip&field_ID="+d+"&b2evo_icons_type=glyphicons",success:function(a){if(ajax_response_is_correct(a)){a=ajax_debug_clear(a),f.html(a);var c=!0;b.hasClass("popoverfield")&&(c=!1,b.removeClass("popoverfield")),e.content=f.html(),b.popover(e),c&&b.popover("show")}b.addClass("popoverfield")}})}else""!=jQuery("#"+c).html()&&(e.content=jQuery("#"+c).html(),b.popover(e),b.popover("show"),b.addClass("popoverfield"));a++}}),jQuery(document).on("blur","[rel^=ufdf_]",function(){jQuery(this).addClass("popoverfield")}),jQuery(document).on("click",".popover-userfield",function(){jQuery(this).next().find('span[class*="icon"]:first').click()})}),jQuery(document).ready(function(){var a=1;jQuery(".form_color_input").each(function(){var b="farbtastic_colorpicker_"+a;jQuery("body").append('<div id="'+b+'" style="display:none"></div>');var c=jQuery.farbtastic("#"+b);c.linkTo(this),jQuery(this).popover({trigger:"manual",placement:"right",html:!0,content:jQuery("#"+b)}),jQuery(this).focus(function(){var a=jQuery(this).parent().find(".popover");0==a.length?(jQuery("#"+b).show(),jQuery(this).popover("show")):a.show()}).blur(function(){var a=jQuery(this).parent().find(".popover");a.length>0&&a.hide()}),a++})});